{
  "version": 3,
  "sources": ["../node_modules/.pnpm/component-emitter@2.0.0/node_modules/component-emitter/index.js", "../lib/kompas.js", "../index.js"],
  "sourcesContent": ["function Emitter(object) {\n\tif (object) {\n\t\treturn mixin(object);\n\t}\n\n\tthis._callbacks = new Map();\n}\n\nfunction mixin(object) {\n\tObject.assign(object, Emitter.prototype);\n\tobject._callbacks = new Map();\n\treturn object;\n}\n\nEmitter.prototype.on = function (event, listener) {\n\tconst callbacks = this._callbacks.get(event) ?? [];\n\tcallbacks.push(listener);\n\tthis._callbacks.set(event, callbacks);\n\treturn this;\n};\n\nEmitter.prototype.once = function (event, listener) {\n\tconst on = (...arguments_) => {\n\t\tthis.off(event, on);\n\t\tlistener.apply(this, arguments_);\n\t};\n\n\ton.fn = listener;\n\tthis.on(event, on);\n\treturn this;\n};\n\nEmitter.prototype.off = function (event, listener) {\n\tif (event === undefined && listener === undefined) {\n\t\tthis._callbacks.clear();\n\t\treturn this;\n\t}\n\n\tif (listener === undefined) {\n\t\tthis._callbacks.delete(event);\n\t\treturn this;\n\t}\n\n\tconst callbacks = this._callbacks.get(event);\n\tif (callbacks) {\n\t\tfor (const [index, callback] of callbacks.entries()) {\n\t\t\tif (callback === listener || callback.fn === listener) {\n\t\t\t\tcallbacks.splice(index, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (callbacks.length === 0) {\n\t\t\tthis._callbacks.delete(event);\n\t\t} else {\n\t\t\tthis._callbacks.set(event, callbacks);\n\t\t}\n\t}\n\n\treturn this;\n};\n\nEmitter.prototype.emit = function (event, ...arguments_) {\n\tconst callbacks = this._callbacks.get(event);\n\tif (callbacks) {\n\t\t// Create a copy of the callbacks array to avoid issues if it's modified during iteration\n\t\tconst callbacksCopy = [...callbacks];\n\n\t\tfor (const callback of callbacksCopy) {\n\t\t\tcallback.apply(this, arguments_);\n\t\t}\n\t}\n\n\treturn this;\n};\n\nEmitter.prototype.listeners = function (event) {\n\treturn this._callbacks.get(event) ?? [];\n};\n\nEmitter.prototype.listenerCount = function (event) {\n\tif (event) {\n\t\treturn this.listeners(event).length;\n\t}\n\n\tlet totalCount = 0;\n\tfor (const callbacks of this._callbacks.values()) {\n\t\ttotalCount += callbacks.length;\n\t}\n\n\treturn totalCount;\n};\n\nEmitter.prototype.hasListeners = function (event) {\n\treturn this.listenerCount(event) > 0;\n};\n\n// Aliases\nEmitter.prototype.addEventListener = Emitter.prototype.on;\nEmitter.prototype.removeListener = Emitter.prototype.off;\nEmitter.prototype.removeEventListener = Emitter.prototype.off;\nEmitter.prototype.removeAllListeners = Emitter.prototype.off;\n\nif (typeof module !== 'undefined') {\n\tmodule.exports = Emitter;\n}\n", "const emitter = require('component-emitter');\n\nmodule.exports = tracker;\n\nconst RAD_PER_DEG = Math.PI / 180;\n\nfunction toRad(deg) {\n  return deg * RAD_PER_DEG;\n}\n\nfunction toDeg(rad) {\n  return rad / RAD_PER_DEG;\n}\n\nfunction compassHeading({ alpha, beta, gamma }) {\n  if (typeof alpha !== 'number' || typeof beta !== 'number' || typeof gamma !== 'number') {\n    return;\n  }\n\n  const _x = toRad(beta);\n  const _y = toRad(gamma);\n  const _z = toRad(alpha);\n\n  const sX = Math.sin(_x);\n  const sY = Math.sin(_y);\n  const sZ = Math.sin(_z);\n\n  // const cX = Math.cos(_x);\n  const cY = Math.cos(_y);\n  const cZ = Math.cos(_z);\n\n  const Vx = -cZ * sY - sZ * sX * cY;\n  const Vy = -sZ * sY + cZ * sX * cY;\n\n  // Calculate compass heading\n  let heading = Math.atan(Vx / Vy);\n\n  // Convert from half unit circle to whole unit circle\n  if (Vy < 0) {\n    heading += Math.PI;\n  } else if (Vx < 0) {\n    heading += 2 * Math.PI;\n  }\n\n  return toDeg(heading);\n}\n\nfunction tracker({ calculate = true } = {}) {\n  let watching = false;\n  let lastHeading;\n  const DO_EVENT = 'ondeviceorientationabsolute' in window ?\n    'deviceorientationabsolute' :\n    'deviceorientation';\n\n  const self = {\n    watch,\n    clear\n  };\n\n  function onDeviceOrientation(ev) {\n    let heading;\n    if ('compassHeading' in ev) {\n      heading = ev.compassHeading;\n    } else if ('webkitCompassHeading' in ev) {\n      heading = ev.webkitCompassHeading;\n    } else if (calculate && ev.absolute) {\n      heading = compassHeading(ev);\n    }\n    if (typeof heading === 'number' && !Number.isNaN(heading)) {\n      heading = Math.round(heading);\n      if (lastHeading !== heading) {\n        self.emit('heading', heading);\n        lastHeading = heading;\n      }\n    }\n  }\n\n  function watch() {\n    if (!watching) {\n      watching = true;\n      window.addEventListener(DO_EVENT, onDeviceOrientation);\n    }\n    return self;\n  }\n\n  function clear() {\n    if (watching) {\n      window.removeEventListener(DO_EVENT, onDeviceOrientation);\n      watching = false;\n    }\n    return self;\n  }\n\n  return emitter(self);\n}\n", "module.exports = require('./lib/kompas');\n"],
  "mappings": "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",
  "names": ["require_kompas"]
}
